!
! ================================================================
! CLOUD AVAILABILITY ZONE - SPINE1 CONFIGURATION
! ================================================================
! Generated: 2025-08-05 02:43:07 UTC
! Device: SPINE1 (SPINE)
! OS: NXOS
! Management IP: 192.168.100.11
! Credentials: admin/cisco123
! ================================================================
!

!
! === BASE SYSTEM CONFIGURATION (NX-OS) ===
!
hostname SPINE1
!
feature ospf
feature bgp
feature hsrp
feature interface-vlan
feature vpc
feature lacp
feature lldp
feature bfd
feature dhcp
!
no password strength-check
username admin password 0 cisco123 role network-admin
username admin keypair generate rsa
!
ip domain-name cloud-automation.local
ip name-server 8.8.8.8 8.8.4.4
!
interface mgmt0
  description Management Interface
  ip address 192.168.100.11/24
  no shutdown
!
vrf context management
  ip route 0.0.0.0/0 192.168.100.1
!
boot nxos bootflash:nxos.9.3.8.bin
!
clock timezone UTC 0 0
clock summer-time UTC recurring
!
banner motd ^
================================================================
    CLOUD AVAILABILITY ZONE - SPINE1
    Network Automation Platform
    Unauthorized access prohibited
================================================================
^
!

!
! === INTERFACE CONFIGURATION ===
!
interface ethernet1/1
  description P2P-Link-to-LEAF1
  no switchport
  ip address 10.100.100.1/30
  no shutdown
  ip ospf bfd
!
interface ethernet1/2
  description P2P-Link-to-LEAF2
  no switchport
  ip address 10.100.100.5/30
  no shutdown
  ip ospf bfd
!
interface ethernet1/3
  description P2P-Link-to-LEAF3
  no switchport
  ip address 10.100.100.9/30
  no shutdown
  ip ospf bfd
!
interface ethernet1/4
  description P2P-Link-to-LEAF4
  no switchport
  ip address 10.100.100.13/30
  no shutdown
  ip ospf bfd
!
interface ethernet1/5
  description P2P-Link-to-SPINE2
  no switchport
  ip address 10.100.100.17/30
  no shutdown
  ip ospf bfd
!
interface loopback0
  description Network Interface
  no shutdown
!


!
! === OSPF CONFIGURATION ===
!
router ospf 1
  router-id 1.1.1.1
  log-adjacency-changes detail
  auto-cost reference-bandwidth 100000
  area 0 authentication message-digest
  graceful-restart
  graceful-restart grace-period 60
  max-lsa 12000
  timers throttle lsa 0 50 5000
  timers throttle spf 50 200 5000
  passive-interface default
  bfd all-interfaces
!interface ethernet1/1
  ip router ospf 1 area 0
  ip ospf network point-to-point
  ip ospf hello-interval 1
  ip ospf dead-interval 3
  ip ospf message-digest-key 1 md5 CloudAutomation123!
  no passive-interface ethernet1/1
!interface ethernet1/2
  ip router ospf 1 area 0
  ip ospf network point-to-point
  ip ospf hello-interval 1
  ip ospf dead-interval 3
  ip ospf message-digest-key 1 md5 CloudAutomation123!
  no passive-interface ethernet1/2
!interface ethernet1/3
  ip router ospf 1 area 0
  ip ospf network point-to-point
  ip ospf hello-interval 1
  ip ospf dead-interval 3
  ip ospf message-digest-key 1 md5 CloudAutomation123!
  no passive-interface ethernet1/3
!interface ethernet1/4
  ip router ospf 1 area 0
  ip ospf network point-to-point
  ip ospf hello-interval 1
  ip ospf dead-interval 3
  ip ospf message-digest-key 1 md5 CloudAutomation123!
  no passive-interface ethernet1/4
!interface ethernet1/5
  ip router ospf 1 area 0
  ip ospf network point-to-point
  ip ospf hello-interval 1
  ip ospf dead-interval 3
  ip ospf message-digest-key 1 md5 CloudAutomation123!
  no passive-interface ethernet1/5
!interface loopback0
  ip router ospf 1 area 0
  ip ospf network point-to-point
  ip ospf hello-interval 1
  ip ospf dead-interval 3
  ip ospf message-digest-key 1 md5 CloudAutomation123!
  no passive-interface loopback0
!

!
! === BGP CONFIGURATION ===
!
router bgp 65000
  router-id 1.1.1.1
  bestpath as-path multipath-relax
  bestpath compare-routerid
  reconnect-interval 12
  log-neighbor-changes
  graceful-restart restart-time 120
  graceful-restart stalepath-time 300
  
  address-family ipv4 unicast
    redistribute ospf 1 route-map OSPF-TO-BGP
    redistribute direct route-map CONNECTED-TO-BGP
    maximum-paths 8
    maximum-paths ibgp 8
    distance bgp 20 200 200
    dampening 15 750 2000 60
  
  address-family l2vpn evpn
    maximum-paths 8
    maximum-paths ibgp 8
    retain route-target all
  
  template peer LEAF-PEERS
    remote-as 65000
    update-source loopback0
    timers 3 9
    password CloudBGP123!
    address-family ipv4 unicast
      send-community
      send-community extended
      route-reflector-client
      soft-reconfiguration inbound
      maximum-prefix 1000 85 restart 5
    address-family l2vpn evpn
      send-community
      send-community extended
      route-reflector-client
  
  neighbor 11.11.11.11
    description LEAF1
    inherit peer LEAF-PEERS
  
  neighbor 12.12.12.12
    description LEAF2
    inherit peer LEAF-PEERS
  
  neighbor 13.13.13.13
    description LEAF3
    inherit peer LEAF-PEERS
  
  neighbor 14.14.14.14
    description LEAF4
    inherit peer LEAF-PEERS
  
  neighbor 2.2.2.2
    description SPINE2
    inherit peer LEAF-PEERS

!
!
! BGP Route Maps
!
route-map OSPF-TO-BGP permit 10
  match ip address prefix-list LOOPBACKS
  set origin igp
  set local-preference 200
  set community 65000:100
!
route-map OSPF-TO-BGP permit 20
  match ip address prefix-list SERVER-NETWORKS
  set origin igp
  set local-preference 150
  set community 65000:200
!
route-map OSPF-TO-BGP deny 30
!
route-map CONNECTED-TO-BGP permit 10
  match ip address prefix-list LOOPBACKS
  set origin igp
  set local-preference 200
  set community 65000:100
!
route-map CONNECTED-TO-BGP deny 20
!
ip prefix-list LOOPBACKS permit 1.1.1.1/32
ip prefix-list LOOPBACKS permit 2.2.2.2/32
ip prefix-list LOOPBACKS permit 11.11.11.11/32
ip prefix-list LOOPBACKS permit 12.12.12.12/32
ip prefix-list LOOPBACKS permit 13.13.13.13/32
ip prefix-list LOOPBACKS permit 14.14.14.14/32
!
ip prefix-list SERVER-NETWORKS permit 192.168.100.0/24
ip prefix-list SERVER-NETWORKS permit 192.168.200.0/24
ip prefix-list SERVER-NETWORKS permit 192.168.30.0/24
!

!
! === HSRP CONFIGURATION ===
!
!
! Track Objects
track 1 interface ethernet1/1 line-protocol
track 2 interface ethernet1/2 line-protocol
track 3 interface ethernet1/3 line-protocol
track 4 interface ethernet1/4 line-protocol
!
interface vlan100
  description Web-Servers-Gateway
  no shutdown
  ip address 192.168.100.2/24
  
  hsrp version 2
  hsrp 100
    authentication md5 key-string CloudHSRP123!
    preempt delay minimum 30
    priority 110
    timers 1 3
    ip 192.168.100.1
    track 1 decrement 20
    track 2 decrement 20
    track 3 decrement 20
    track 4 decrement 20
    use-bia
!interface vlan200
  description App-Servers-Gateway
  no shutdown
  ip address 192.168.200.2/24
  
  hsrp version 2
  hsrp 200
    authentication md5 key-string CloudHSRP123!
    preempt delay minimum 30
    priority 110
    timers 1 3
    ip 192.168.200.1
    track 1 decrement 20
    track 2 decrement 20
    track 3 decrement 20
    track 4 decrement 20
    use-bia
!interface vlan300
  description DB-Servers-Gateway
  no shutdown
  ip address 192.168.30.2/24
  
  hsrp version 2
  hsrp 300
    authentication md5 key-string CloudHSRP123!
    preempt delay minimum 30
    priority 110
    timers 1 3
    ip 192.168.30.1
    track 1 decrement 20
    track 2 decrement 20
    track 3 decrement 20
    track 4 decrement 20
    use-bia
!

!
! === QoS CONFIGURATION ===
!
system qos
qos statistics
!
class-map type qos match-any VOICE
  match dscp ef
!
class-map type qos match-any VIDEO
  match dscp af41
  match dscp af42
  match dscp af43
!
class-map type qos match-any CRITICAL-DATA
  match dscp af31
  match dscp af32
  match dscp af33
!
policy-map type qos EGRESS-POLICY
  class VOICE
    priority level 1
    bandwidth percent 20
    queue-limit 64 packets
    set dscp ef
  class VIDEO
    bandwidth percent 30
    queue-limit 64 packets
    set dscp af41
  class CRITICAL-DATA
    bandwidth percent 25
    queue-limit 64 packets
    set dscp af31
  class class-default
    bandwidth percent remaining
    queue-limit 64 packets
    random-detect
!

!
! === SECURITY CONFIGURATION ===
!
aaa new-model
aaa authentication login default local
aaa authentication enable default enable
aaa authorization console
aaa authorization exec default local
aaa accounting exec default start-stop local
aaa accounting commands 15 default start-stop local
!username admin privilege 15 secret 0 cisco123
username operator privilege 10 secret 0 operator123
username readonly privilege 1 secret 0 readonly123
!ip ssh version 2
ip ssh time-out 60
ip ssh authentication-retries 3
crypto key generate rsa general-keys modulus 2048
!line console 0
  login authentication default
  logging synchronous
  exec-timeout 10 0
line vty 0 15
  login authentication default
  transport input ssh
  exec-timeout 10 0
  logging synchronous
!no feature telnet
no ip http server
no ip http secure-server
!

!
! === MONITORING CONFIGURATION ===
!
snmp-server community CloudRO RO
snmp-server community CloudRW RW
snmp-server location Cloud Availability Zone
snmp-server contact Network Operations Center
snmp-server enable traps
!logging buffered 32768
logging console warnings
logging monitor warnings
logging trap informational
logging facility local0
logging source-interface loopback0
logging host 192.168.100.200
!ntp authenticate
ntp authentication-key 1 md5 CloudNTP123!
ntp trusted-key 1
ntp server 192.168.100.201 key 1 prefer
ntp server 192.168.100.202 key 1
ntp source loopback0
!

!
! ================================================================
! END OF CONFIGURATION - SPINE1
! ================================================================
!
